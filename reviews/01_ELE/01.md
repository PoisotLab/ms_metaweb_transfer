# Responses to reviewers comments

## Editor in chief

Three reviewers and an AE have looked at your manuscript. One reviewer and the
AE recommend rejection, because any revision would essentially result in quite a
different paper. Two other reviewers are critical, but suspect the manuscript
could be revised.  On balance, i have decided to keep the door open a jar, and
will allow a very significantly revised manuscript to be resubmitted. You may
decide the ask is too much, and try publishing elsewhere.

In particular, it is important that the major criticisms of the AE and reviewer
2 are all addressed. These get to the heart of the issue. The method is elegant,
but we just don't know how well it will work in real life situations. We need
some validation. The manuscript also requires additional methodological details,
and some new model runs. Some of these can be included in Supplementary
Information, but they are important.

## Associate editor

The manuscript presents an interesting study with promising results directed
towards important future research. However, based on the following limitations,
it would fit better to a methodological/theoretical journal, and an essentially
different paper would only be acceptable for a top journal: (1) the presentation
could be improved by providing a richer context of the problem, (2) some major
details of the approach need to be re-thought, like trait distribution, (3) one
or several case studies should be used for testing/validating the approach, (4)
beyond (3), also a discussion should clarify the generality of the approach
(whether its use is of more tactical or more strategic nature). I see a change
to transform the manuscript to a very good paper but also in its present form it
is useful and appropriate to a minor journal.

## Referee 1

The Manuscript ELE-01066-2021 addresses the important question of how to infer
species interactions and inherent networks. Authors used machine learning
algorithms to this end, using a foodweb of European mammals as training datasets
to make predictions on potential foodweb involving Canadian mammals. Results
indicate that the algorithm has a good predictive power, although it largely
tends to overestimate uncommon interactions. Authors conclude that colonialism
and nationalism are detrimental to biodiversity.

This is a nice study that sheds some new light into a fascinating problem in
ecology, that of inferring species interactions. Although the phenomenological
nature of the study and the black box of machine learning do not allow us to
understand WHY nor HOW, the algorithm made the correct inference most of the
time. I enjoyed reading the paper and I admire its concise way in highlighting
the main methodologies and their relevance. This paper will certainly be of
interest to ELE readers.

I have some suggestions that shall improve the clarity of the manuscript and the
strength of its claims.

It sounds like authors are reinventing the wheel. Please provide a more thorough
introduction to current methods and knowledge on predicting ecological networks.
Especially, the submitted manuscript looks scarily similar to that of Runghen,
R. et al. (incomplete reference in the list). Such similarity poses some doubts
regarding its novelty and originality. Also, the literature cited is quite
self-referential.

Some fundamental information is missing. This current paper must be
self-contained. Please provide more information about the European network:
which community, species interaction type, ecosystem, biome, climate, spatial
extent, time scale. Authors cannot force readers to go get such information
somewhere else.

Trait distribution. Please run the model using a normal distribution instead of
a uniform one. Why did you chose a UD? “Traits” are NOT uniformly distributed at
all. How does this affect the estimates? Please provide new results.
Furthermore, please do not create false expectation in the reader by continuing
referring to traits when, in fact, those are just node topological properties.
Please mind the difference between a node degree and a species trait; here,
there are no actual functional nor phenotypic traits, being node degree rank a
purely topological property.

Manuscript structure. Intro and discussion are quite sterile, they miss the
point. The state-of-the-art is not presented thoroughly as it does not build on
what we do and know so far. Furthermore, the discussion is a complete separate
piece, a random digression detached from the rest of the manuscript. Linked to
that, the conclusion, although I truly love it, is quite out of context. Please
seriously improve those parts.

Please discuss your results in light of your large overestimations.

Figures 3 and Fig. 6c are of bad quality. Please improve them.

Please find attached minor, detailed comments.

## Referee 2

This is a novel paper which uses phylogenetic signal as a way of constructing
food webs from community composition data. The approach is illustrated
constructing a Canadian mammal food web by drawing on European data.

The paper is well written and of an appropriate length. The approach is well
described in a clear way.

My concern with these modelling approaches (and the broader use of metawebs) is
that is that the approach itself is a very conservative one which will tend to
'average out' differences across locations. Because the paper does not have an
associated case study showing that it can actually detect differences in food
web structure between places or times, the risk is that this is a method which
allows an increase in the number of food webs - while at the same time
predisposing them to all look identical.

The second issue is to do with when and how the phylogenetic signal would be
most robust at predicting trophic interactions. Presumably systems dominated by
generalists  and with high phylogenetic overlap with the region generating the
predictions will be very reliable in predicting food webs. However for areas
with high endemism and limited species pools which may have favoured
specialisation I am less convinced. Is it possible that some metric of
phylogenetic relatedness across the metaweb should be reported in carrying out
this kind of modelling .

As with the use of metawebs, my concern is that some of the most interesting
ecology would be obscured by constructing food webs in this way.

What I would really liked to have seen was a case study which showed were a set
of food webs had been able to show a clear ecological pattern (e.g. David Post's
lake food webs showing relationships with size and productivity), reconstruct
those food webs using the modelling approach and show that the pattern was still
evident, and not averaged away by the process of inferring the food webs.

## Referee 3

In this study, the authors developed a data-driven framework for the prediction
of unknown ecological networks. Specifically, as far as my understanding, the
analytical procedure is as the following three steps.

First, for a known ecological network (food web of European mammalian in this
case), the latent generality trait (i.e., prey species composition) and
vulnerability trait (predator species composition) are extracted by performing
t-SVD of the interaction (adjacency) matrix. Then, the generality/vulnerability
traits of species in the other community with an unknown network structure are
estimated by mapping the extracted traits of the known community onto global
phylogeny. Finally, left and right subspaces of the target community are
probabilistically obtained based on the estimated generality/vulnerability
traits: multiplying these subspaces yield the probabilistic network realization
of the unknown community. Applying this framework to the established European
food web and mammalian phylogeny, the authors reconstructed the hitherto unknown
trophic network of Canadian mammals.

Overall, I agree with the ecological importance of the topic covered in this
study (i.e., how to infer the network structure of an ecological community where
there is poor knowledge or lack of direct observations of species interaction).
However, the text is hard to follow, and I feel there is room to revise,
especially for its presentation.

For example, the authors used RDPG (random dot product graph) to obtain the
latent feature subspaces, but I didn’t know anything about this method, so I
couldn’t understand how it relates to SVD from the text alone. Thus, I suggest
the authors add the text that explains the concept of the RDPG (e.g., this
assumes that interaction occurs more often between the species with similar
functional traits) and that SVD is a promising method to provide these
functional traits from the observed network data. Similar incomprehensible
points may be found in the Methods.

In addition, I am wondering if all the results are described correctly.
Specifically, the authors assert that the reconstructed Canadian food web
recovers over 95% of known interactions by comparing databases of recorded
pairwise interactions. However, I found no corresponding description in “Results
and discussion of the case study” section (and also “Data cleanup, discovery,
validation, and thresholding” section). Thus, if the result exists, please add
it to the appropriate part and otherwise remove the description from the
abstract.

Minor comments:

L119–120: The logic is unclear. Is there any assumption that a list of prey and
predator species tend to be similar among closely related species? Please
clarify.

L143 & 296: 'a' RDPG -> an RDPG?

L150–153: Did you use all the data in the European metaweb for an interaction
presence/absence classification analysis? If this is true, overfitting may occur
in determining the threshold for interaction probability. Thus, I suggest the
authors adopt some approaches to avoid overfitting, such as the cross-validation
methods.

L247–249 & top panels in Fig. 6. I consider these results are algebraically
self-evident. Specifically, 1st left and right singular vectors correspond to
the direction with the highest variance for the row- and column-wise elements,
respectively. That is, elements with greater contribution to these 1st singular
vectors tend to have larger values for the row or column vector in the original
matrix. Therefore, I think these results provide no novel information, and a
simple statement of this should suffice.

L301–304. In addition to the authors' mention, I think biased information of
species interactions toward specific behaviours or ecological relationships may
significantly limit such approaches. As you know, there are various types of
ecological relationships, such as competition, mutualism, etc. However, for many
of them, species interactions have not yet been studied as much as for trophic
relationships (e.g., Kéfi et al. 2012, Ecol Lett). Furthermore, a recent study
implied that, even in a community that has been studied as a prey-predator
system, various unanticipated interactions (these might not be trophic ones)
play a significant role in its dynamics (Kawatsu et al. 2021, Ecol Lett).
Applying the approach proposed in this paper to such a system would result in
biased predictions. Please discuss this point in the manuscript.
